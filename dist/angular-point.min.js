"use strict";try{angular.module("toastr")}catch(e){angular.module("toastr",[]).factory("toastr",["$log",function(a){return{error:a.error,info:a.info,success:a.info,warning:a.warn}}])}angular.module("angularPoint",["toastr"]),angular.module("angularPoint").config(["apConfig",function(a){a.online=!a.offline}]),function(){angular.module("angularPoint").constant("apDefaultFields",[{staticName:"ID",objectType:"Counter",mappedName:"id",readOnly:!0},{staticName:"Modified",objectType:"DateTime",mappedName:"modified",readOnly:!0},{staticName:"Created",objectType:"DateTime",mappedName:"created",readOnly:!0},{staticName:"Author",objectType:"User",mappedName:"author",readOnly:!0},{staticName:"Editor",objectType:"User",mappedName:"editor",readOnly:!0},{staticName:"PermMask",objectType:"Mask",mappedName:"permMask",readOnly:!0},{staticName:"UniqueId",objectType:"String",mappedName:"uniqueId",readOnly:!0},{staticName:"FileRef",objectType:"Lookup",mappedName:"fileRef",readOnly:!0}])}(),function(){angular.module("angularPoint").constant("apDefaultListItemQueryOptions","<QueryOptions>   <IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns>   <IncludeAttachmentUrls>TRUE</IncludeAttachmentUrls>   <IncludeAttachmentVersion>FALSE</IncludeAttachmentVersion>   <ExpandUserField>FALSE</ExpandUserField></QueryOptions>")}(),angular.module("angularPoint").constant("apWebServiceOperationConstants",{GetAlerts:["Alerts",!1],DeleteAlerts:["Alerts",!0],Mode:["Authentication",!1],Login:["Authentication",!1],CopyIntoItems:["Copy",!0],CopyIntoItemsLocal:["Copy",!0],GetItem:["Copy",!1],GetForm:["Forms",!1],GetFormCollection:["Forms",!1],AddAttachment:["Lists",!0],AddDiscussionBoardItem:["Lists",!0],AddList:["Lists",!0],AddListFromFeature:["Lists",!0],ApplyContentTypeToList:["Lists",!0],CheckInFile:["Lists",!0],CheckOutFile:["Lists",!0],CreateContentType:["Webs",!0],DeleteAttachment:["Lists",!0],DeleteContentType:["Lists",!0],DeleteContentTypeXmlDocument:["Lists",!0],DeleteList:["Lists",!0],GetAttachmentCollection:["Lists",!1],GetList:["Lists",!1],GetListAndView:["Lists",!1],GetListCollection:["Lists",!1],GetListContentType:["Lists",!1],GetListContentTypes:["Lists",!1],GetListItemChanges:["Lists",!1],GetListItemChangesSinceToken:["Lists",!1],GetListItems:["Lists",!1],GetVersionCollection:["Lists",!1],UndoCheckOut:["Lists",!0],UpdateContentType:["Webs",!0],UpdateContentTypesXmlDocument:["Lists",!0],UpdateContentTypeXmlDocument:["Lists",!0],UpdateList:["Lists",!0],UpdateListItems:["Lists",!0],AddMeeting:["Meetings",!0],CreateWorkspace:["Meetings",!0],RemoveMeeting:["Meetings",!0],SetWorkSpaceTitle:["Meetings",!0],ResolvePrincipals:["People",!1],SearchPrincipals:["People",!1],AddPermission:["Permissions",!0],AddPermissionCollection:["Permissions",!0],GetPermissionCollection:["Permissions",!0],RemovePermission:["Permissions",!0],RemovePermissionCollection:["Permissions",!0],UpdatePermission:["Permissions",!0],GetLinks:["PublishedLinksService",!0],GetPortalSearchInfo:["Search",!1],GetQuerySuggestions:["Search",!1],GetSearchMetadata:["Search",!1],Query:["Search",!1],QueryEx:["Search",!1],Registration:["Search",!1],Status:["Search",!1],SendClientScriptErrorReport:["SharePointDiagnostics",!0],GetAttachments:["SiteData",!1],EnumerateFolder:["SiteData",!1],SiteDataGetList:["SiteData",!1],SiteDataGetListCollection:["SiteData",!1],SiteDataGetSite:["SiteData",!1],SiteDataGetSiteUrl:["SiteData",!1],SiteDataGetWeb:["SiteData",!1],CreateWeb:["Sites",!0],DeleteWeb:["Sites",!0],GetSite:["Sites",!1],GetSiteTemplates:["Sites",!1],AddComment:["SocialDataService",!0],AddTag:["SocialDataService",!0],AddTagByKeyword:["SocialDataService",!0],CountCommentsOfUser:["SocialDataService",!1],CountCommentsOfUserOnUrl:["SocialDataService",!1],CountCommentsOnUrl:["SocialDataService",!1],CountRatingsOnUrl:["SocialDataService",!1],CountTagsOfUser:["SocialDataService",!1],DeleteComment:["SocialDataService",!0],DeleteRating:["SocialDataService",!0],DeleteTag:["SocialDataService",!0],DeleteTagByKeyword:["SocialDataService",!0],DeleteTags:["SocialDataService",!0],GetAllTagTerms:["SocialDataService",!1],GetAllTagTermsForUrlFolder:["SocialDataService",!1],GetAllTagUrls:["SocialDataService",!1],GetAllTagUrlsByKeyword:["SocialDataService",!1],GetCommentsOfUser:["SocialDataService",!1],GetCommentsOfUserOnUrl:["SocialDataService",!1],GetCommentsOnUrl:["SocialDataService",!1],GetRatingAverageOnUrl:["SocialDataService",!1],GetRatingOfUserOnUrl:["SocialDataService",!1],GetRatingOnUrl:["SocialDataService",!1],GetRatingsOfUser:["SocialDataService",!1],GetRatingsOnUrl:["SocialDataService",!1],GetSocialDataForFullReplication:["SocialDataService",!1],GetTags:["SocialDataService",!0],GetTagsOfUser:["SocialDataService",!0],GetTagTerms:["SocialDataService",!0],GetTagTermsOfUser:["SocialDataService",!0],GetTagTermsOnUrl:["SocialDataService",!0],GetTagUrlsOfUser:["SocialDataService",!0],GetTagUrlsOfUserByKeyword:["SocialDataService",!0],GetTagUrls:["SocialDataService",!0],GetTagUrlsByKeyword:["SocialDataService",!0],SetRating:["SocialDataService",!0],UpdateComment:["SocialDataService",!0],SpellCheck:["SpellCheck",!1],AddTerms:["TaxonomyClientService",!0],GetChildTermsInTerm:["TaxonomyClientService",!1],GetChildTermsInTermSet:["TaxonomyClientService",!1],GetKeywordTermsByGuids:["TaxonomyClientService",!1],GetTermsByLabel:["TaxonomyClientService",!1],GetTermSets:["TaxonomyClientService",!1],AddGroup:["usergroup",!0],AddGroupToRole:["usergroup",!0],AddRole:["usergroup",!0],AddRoleDef:["usergroup",!0],AddUserCollectionToGroup:["usergroup",!0],AddUserCollectionToRole:["usergroup",!0],AddUserToGroup:["usergroup",!0],AddUserToRole:["usergroup",!0],GetAllUserCollectionFromWeb:["usergroup",!1],GetGroupCollection:["usergroup",!1],GetGroupCollectionFromRole:["usergroup",!1],GetGroupCollectionFromSite:["usergroup",!1],GetGroupCollectionFromUser:["usergroup",!1],GetGroupCollectionFromWeb:["usergroup",!1],GetGroupInfo:["usergroup",!1],GetRoleCollection:["usergroup",!1],GetRoleCollectionFromGroup:["usergroup",!1],GetRoleCollectionFromUser:["usergroup",!1],GetRoleCollectionFromWeb:["usergroup",!1],GetRoleInfo:["usergroup",!1],GetRolesAndPermissionsForCurrentUser:["usergroup",!1],GetRolesAndPermissionsForSite:["usergroup",!1],GetUserCollection:["usergroup",!1],GetUserCollectionFromGroup:["usergroup",!1],GetUserCollectionFromRole:["usergroup",!1],GetUserCollectionFromSite:["usergroup",!1],GetUserCollectionFromWeb:["usergroup",!1],GetUserInfo:["usergroup",!1],GetUserLoginFromEmail:["usergroup",!1],RemoveGroup:["usergroup",!0],RemoveGroupFromRole:["usergroup",!0],RemoveRole:["usergroup",!0],RemoveUserCollectionFromGroup:["usergroup",!0],RemoveUserCollectionFromRole:["usergroup",!0],RemoveUserCollectionFromSite:["usergroup",!0],RemoveUserFromGroup:["usergroup",!0],RemoveUserFromRole:["usergroup",!0],RemoveUserFromSite:["usergroup",!0],RemoveUserFromWeb:["usergroup",!0],UpdateGroupInfo:["usergroup",!0],UpdateRoleDefInfo:["usergroup",!0],UpdateRoleInfo:["usergroup",!0],UpdateUserInfo:["usergroup",!0],AddColleague:["UserProfileService",!0],AddLink:["UserProfileService",!0],AddMembership:["UserProfileService",!0],AddPinnedLink:["UserProfileService",!0],CreateMemberGroup:["UserProfileService",!0],CreateUserProfileByAccountName:["UserProfileService",!0],GetCommonColleagues:["UserProfileService",!1],GetCommonManager:["UserProfileService",!1],GetCommonMemberships:["UserProfileService",!1],GetInCommon:["UserProfileService",!1],GetPropertyChoiceList:["UserProfileService",!1],GetUserColleagues:["UserProfileService",!1],GetUserLinks:["UserProfileService",!1],GetUserMemberships:["UserProfileService",!1],GetUserPinnedLinks:["UserProfileService",!1],GetUserProfileByGuid:["UserProfileService",!1],GetUserProfileByIndex:["UserProfileService",!1],GetUserProfileByName:["UserProfileService",!1],GetUserProfileCount:["UserProfileService",!1],GetUserProfileSchema:["UserProfileService",!1],GetUserPropertyByAccountName:["UserProfileService",!1],ModifyUserPropertyByAccountName:["UserProfileService",!0],RemoveAllColleagues:["UserProfileService",!0],RemoveAllLinks:["UserProfileService",!0],RemoveAllMemberships:["UserProfileService",!0],RemoveAllPinnedLinks:["UserProfileService",!0],RemoveColleague:["UserProfileService",!0],RemoveLink:["UserProfileService",!0],RemoveMembership:["UserProfileService",!0],RemovePinnedLink:["UserProfileService",!0],UpdateColleaguePrivacy:["UserProfileService",!0],UpdateLink:["UserProfileService",!0],UpdateMembershipPrivacy:["UserProfileService",!0],UpdatePinnedLink:["UserProfileService",!0],DeleteAllVersions:["Versions",!0],DeleteVersion:["Versions",!0],GetVersions:["Versions",!1],RestoreVersion:["Versions",!0],AddView:["Views",!0],DeleteView:["Views",!0],GetView:["Views",!1],GetViewHtml:["Views",!1],GetViewCollection:["Views",!1],UpdateView:["Views",!0],UpdateViewHtml:["Views",!0],AddWebPart:["WebPartPages",!0],AddWebPartToZone:["WebPartPages",!0],GetWebPart2:["WebPartPages",!1],GetWebPartPage:["WebPartPages",!1],GetWebPartProperties:["WebPartPages",!1],GetWebPartProperties2:["WebPartPages",!1],GetColumns:["Webs",!1],GetContentType:["Webs",!1],GetContentTypes:["Webs",!1],GetCustomizedPageStatus:["Webs",!1],GetListTemplates:["Webs",!1],GetObjectIdFromUrl:["Webs",!1],GetWeb:["Webs",!1],GetWebCollection:["Webs",!1],GetAllSubWebCollection:["Webs",!1],UpdateColumns:["Webs",!0],WebUrlFromPageUrl:["Webs",!1],AlterToDo:["Workflow",!0],ClaimReleaseTask:["Workflow",!0],GetTemplatesForItem:["Workflow",!1],GetToDosForItem:["Workflow",!1],GetWorkflowDataForItem:["Workflow",!1],GetWorkflowTaskData:["Workflow",!1],StartWorkflow:["Workflow",!0]}),function(){angular.module("angularPoint").constant("apXMLFieldAttributeTypes",{Decimals:"Number",EnforceUniqueValues:"Boolean",Filterable:"Boolean",FromBaseType:"Boolean",Hidden:"Boolean",Indexed:"Boolean",NumLines:"Number",ReadOnly:"Boolean",Required:"Boolean",Sortable:"Boolean"})}(),function(){angular.module("angularPoint").constant("apXMLListAttributeTypes",{BaseType:"Number",ServerTemplate:"Number",Created:"DateTime",Modified:"DateTime",LastDeleted:"DateTime",Version:"Number",ThumbnailSize:"Number",WebImageWidth:"Number",WebImageHeight:"Number",Flags:"Number",ItemCount:"Number",ReadSecurity:"Number",WriteSecurity:"Number",Author:"Number",MajorWithMinorVersionsLimit:"Number",HasUniqueScopes:"Boolean",NoThrottleListOperations:"Boolean",HasRelatedLists:"Boolean",AllowDeletion:"Boolean",AllowMultiResponses:"Boolean",EnableAttachments:"Boolean",EnableModeration:"Boolean",EnableVersioning:"Boolean",HasExternalDataSource:"Boolean",Hidden:"Boolean",MultipleDataList:"Boolean",Ordered:"Boolean",ShowUser:"Boolean",EnablePeopleSelector:"Boolean",EnableResourceSelector:"Boolean",EnableMinorVersion:"Boolean",RequireCheckout:"Boolean",ThrottleListOperations:"Boolean",ExcludeFromOfflineClient:"Boolean",EnableFolderCreation:"Boolean",IrmEnabled:"Boolean",IsApplicationList:"Boolean",PreserveEmptyValues:"Boolean",StrictTypeCoercion:"Boolean",EnforceDataValidation:"Boolean",MaxItemsPerThrottledOperation:"Number"})}(),angular.module("angularPoint").constant("_",_).constant("apConfig",{appTitle:"Angular-Point",debug:!1,defaultQueryName:"primary",defaultUrl:"",environment:"production",firebaseURL:"The optional url of your firebase source",offline:window.location.href.indexOf("localhost")>-1||window.location.href.indexOf("http://0.")>-1||window.location.href.indexOf("http://10.")>-1||window.location.href.indexOf("http://192.")>-1,offlineXML:"dev/"}),angular.module("angularPoint").factory("apCacheService",["$q","$log","_","apIndexedCacheFactory",function(a,b,c,d){function e(){}function f(a,b){var c=this;c.associationQueue=[],c.updateCount=0,c.listId=j(a),c.entityId=b,c.entityLocations=[]}function g(a){if(a.list&&a.list.getListId()&&a.list.title){var b=a.list.getListId().toLowerCase();u[a.list.title]={model:a,listId:b},v[b]={model:a}}}function h(a){var b,c=j(a);return v[c]&&(b=v[c].model),b}function i(a){var b;return u[a]&&u[a].listId&&(b=u[a].listId),b}function j(a){return c.isGuid(a)?a.toLowerCase():i(a)}function k(){var b=this,c=a.defer();return b.entity?c.resolve(b.entity):b.associationQueue.push(c),c.promise}function l(a,b){return t(a,b).entity}function m(a){var b=s(a),e=d.create();return c.each(b,function(a){a.entity&&a.entity.id&&e.addEntity(a.entity)}),e}function n(a,b){var c=t(a,b);return c.getEntity()}function o(a,b){var d=a.getModel(),e=t(d.list.getListId(),a.id);return c.isObject(e.entity)?c.extend(e.entity,a):e.entity=a,e.updateCount++,c.isObject(b)&&!c.isArray(b)&&(b[a.id]=a),c.each(e.associationQueue,function(b){b.resolve(a),e.associationQueue.shift()}),e.entity}function p(){var a=this;q(a.listId,a.entityId)}function q(a,b){var c=s(a,b);c[b]&&delete c[b]}function r(a,b){var d=j(a);q(d,b);var e=h(d);c.each(e.queries,function(a){var c=a.getCache();c.removeEntity(b)})}function s(a){var b=j(a);return w[b]=w[b]||new e,w[b]}function t(a,b){var c=j(a),d=s(c);return d[b]=d[b]||new f(c,b),d[b]}var u={},v={},w={};return e.prototype=d.create(),e.constructor=e,f.prototype={getEntity:k,removeEntity:p},{deleteEntity:r,entityCache:w,getCachedEntity:l,getCachedEntities:m,getEntity:n,getEntityContainer:t,getListIdFromListName:i,getListId:j,getModel:h,removeEntity:q,registerEntity:o,registerModel:g}}]),angular.module("angularPoint").factory("apDataService",["$q","$timeout","$http","_","apQueueService","apConfig","apUtilityService","apCacheService","apDecodeService","apEncodeService","apFieldService","apIndexedCacheFactory","toastr","SPServices","apDefaultListItemQueryOptions","apWebServiceOperationConstants","apXMLToJSONService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(b){var e=a.defer(),f=n.generateXMLComponents(b),g=p[b.operation][0];return y(g,b.webURL).then(function(a){c({method:"POST",url:a,data:f.msg,responseType:"document",headers:{"Content-Type":"text/xml;charset='utf-8'"},transformRequest:function(a,b){if(f.SOAPAction){var c=b();c.SOAPAction=f.SOAPAction}return a},transformResponse:function(a){return d.isString(a)&&(a=$.parseXML(a)),a}}).then(function(a){var c=i.checkResponseForErrors(a.data);c?(console.error(c,b),e.reject(c)):e.resolve(a.data)},function(a){var c=i.checkResponseForErrors(a.data);console.error(a.statusText,b),e.reject(a.statusText+": "+c)})}),e.promise}function s(b){function c(a){if(h.filterNode){var b=$(a).SPFilterNode(h.filterNode);return q(b,{includeAllAttrs:!0,removeOws:!1})}return a}var g={postProcess:c,webURL:f.defaultUrl},h=d.extend({},g,b),i=a.defer();return e.increase(),O.requestData(h).then(function(a){var b=h.postProcess(a);e.decrease(),i.resolve(b)},function(a){m.error("Failed to complete the requested "+h.operation+" operation."),e.decrease(),i.reject(a)}),i.promise}function t(b,c){var e={operation:"GetVersionCollection"},f=d.extend({},e,b),g=a.defer();return s(f).then(function(a){var b=i.parseFieldVersions(a,c);g.resolve(b)},function(a){m.error("Failed to fetch version history."),g.reject(a)}),g.promise}function u(b){function c(a){var b=[];if("GetAttachmentCollection"===f.operation)$(a).SPFilterNode(g).each(function(){b.push($(this).text())});else{var c=$(a).SPFilterNode(g);b=q(c,{includeAllAttrs:!0,removeOws:!1})}return b}var e={postProcess:c},f=d.extend({},e,b),g=f.filterNode||f.operation.split("Get")[1].split("Collection")[0],h=a.defer(),i=v(f);return i?s(f).then(function(a){h.resolve(a)}):(m.error("Invalid payload:",f),h.reject()),h.promise}function v(a){var b=!0,c=function(c){d.each(c,function(c){a[c]||(m.error("options"+c+" is required to complete this operation"),b=!1)})};switch(a.operation){case"GetGroupCollectionFromUser":c(["userLoginName"]);break;case"GetUserCollectionFromGroup":c(["groupName"]);break;case"GetViewCollection":c(["listName"]);break;case"GetAttachmentCollection":c(["listName","ID"])}return b}function w(b){var c=a.defer(),d={operation:"GetUserProfileByName"};return b&&(d.accountName=b),s(d).then(function(a){var b={};$(a).SPFilterNode("PropertyData").each(function(){var a=$(this).SPFilterNode("Name"),c=$(this).SPFilterNode("Value");a.length>0&&c.length>0&&(b[a.text().trim()]=c.text().trim())}),b.userLoginName=f.userLoginNamePrefix?f.userLoginNamePrefix+b.AccountName:b.AccountName,c.resolve(b)}),c.promise}function x(b){function c(a){O.serviceWrapper({operation:"GetGroupCollectionFromUser",userLoginName:a,filterNode:"Group"}).then(function(a){d.resolve(a)})}var d=a.defer();return b?c(b):w().then(function(a){c(a.userLoginName)}),d.promise}function y(b,c){var d="_vti_bin/"+b+".asmx",e=a.defer();return c?(d="/"===c.charAt(c.length-1)?c+d:c+"/"+d,e.resolve(d)):z().then(function(a){d=a+("/"===a.charAt(a.length-1)?d:"/"+d),e.resolve(d)}),e.promise}function z(){var b=a.defer(),d=z;if(!d.query){d.query=b.promise;var e=n.SOAPEnvelope.header+"<WebUrlFromPageUrl xmlns='"+n.SCHEMASharePoint+"/soap/' ><pageUrl>"+(location.href.indexOf("?")>0?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+n.SOAPEnvelope.footer;c({method:"POST",url:"/_vti_bin/Webs.asmx",data:e,responseType:"document",headers:{"Content-Type":"text/xml;charset='utf-8'"}}).then(function(a){f.defaultUrl=$(a.data).find("WebUrlFromPageUrlResult").text(),b.resolve(f.defaultUrl)},function(a){var c=i.checkResponseForErrors(a.data);b.reject(c)})}return d.query}function A(a){var b={operation:"GetList"},c=d.extend({},b,a);return s(c)}function B(b){var c=a.defer();return A(b).then(function(a){var b=$(a).SPFilterNode("Field"),d=q(b,{includeAllAttrs:!0,removeOws:!1});c.resolve(d)}),c.promise}function C(a){var b={operation:"DeleteAttachment",filterNode:"Field"},c=d.extend({},b,a);return s(c)}function D(b,c,e){var f={target:b.getCache()},g=a.defer(),h=d.extend({},f,e);return s(c).then(function(a){"GetListItemChangesSinceToken"===c.operation&&E(b,c,a,h);var d=i.processListItems(b,c,a,h);g.resolve(d),c.lastRun=new Date}),g.promise}function E(a,b,c,d){a.fieldDefinitionsExtended||(i.extendListDefinitionFromXML(a.list,c),i.extendFieldDefinitionsFromXML(a.list.fields,c),a.fieldDefinitionsExtended=!0),b.changeToken=F(c);var e=G(c);e&&(a.list.effectivePermMask=e),H(c,d.target)}function F(a){return $(a).find("Changes").attr("LastChangeToken")}function G(a){return $(a).find("listitems").attr("EffectivePermMask")}function H(a,b){$(a).SPFilterNode("Id").each(function(){var a=$(this).attr("ChangeType");if("Delete"===a){var c=parseInt($(this).text(),10);b.removeEntity(c)}})}function I(b,c,e){var f={batchCmd:"New",buildValuePairs:!0,indexedCache:l.create({}),listName:b.list.getListId(),operation:"UpdateListItems",valuePairs:[],webURL:b.list.identifyWebURL()},g=a.defer();f.target=f.indexedCache;var h=d.extend({},f,e);if(h.buildValuePairs===!0){var k=d.where(b.list.fields,{readOnly:!1});h.valuePairs=j.generateValuePairs(k,c)}return h.getCache=function(){return h.indexedCache},s(h,c,b).then(function(a){var c=i.processListItems(b,h,a,h);g.resolve(c.last())},function(a){g.reject(a)}),g.promise}function J(b,c,e){var f={batchCmd:"Update",buildValuePairs:!0,ID:c.id,listName:b.list.getListId(),operation:"UpdateListItems",target:c.getCache(),valuePairs:[],webURL:b.list.identifyWebURL()},g=a.defer(),h=d.extend({},f,e);if(h.buildValuePairs===!0){var k=d.where(b.list.fields,{readOnly:!1});h.valuePairs=j.generateValuePairs(k,c)}return b.list.webURL&&!h.webURL&&(h.webURL=b.list.webURL),s(h,c,b).then(function(a){var d=i.processListItems(b,c.getQuery(),a,h);g.resolve(d[c.id])},function(a){g.reject(a)}),g.promise}function K(b,c,e){var f={target:d.isFunction(c.getCache)?c.getCache():b.getCache(),operation:"UpdateListItems",listName:b.list.getListId(),batchCmd:"Delete",ID:c.id,webURL:b.list.identifyWebURL()},g=d.extend({},f,e),i=a.defer();return s(g).then(function(){h.deleteEntity(g.listName,c.id),i.resolve()},function(a){m.error("There was an error deleting a list item from "+b.list.title),i.reject(a)}),i.promise}function L(a){return window.location.protocol+"//"+window.location.hostname+"/"+a}function M(b){var c=a.defer(),e=b.indexOf("://")>-1?b:L(b);return s({operation:"GetTemplatesForItem",item:e}).then(function(a){var b=[],e=$(a).SPFilterNode("WorkflowTemplate");d.each(e,function(a){var c={name:$(a).attr("Name"),instantiationUrl:$(a).attr("InstantiationUrl"),templateId:"{"+$(a).find("WorkflowTemplateIdSet").attr("TemplateId")+"}"};b.push(c)}),c.resolve(b)}),c.promise}function N(a){var b={operation:"StartWorkflow",item:"",fileRef:"",templateId:"",workflowParameters:"<root />"},c=d.extend({},b,a);return!c.item&&c.fileRef&&(c.item=L(c.fileRef)),s(c)}var O={createListItem:I,deleteAttachment:C,deleteListItem:K,executeQuery:D,generateWebServiceUrl:y,getAvailableWorkflows:M,getCollection:u,getCurrentSite:z,getFieldVersionHistory:t,getGroupCollectionFromUser:x,getList:A,getListFields:B,getUserProfileByName:w,processChangeTokenXML:E,processDeletionsSinceToken:H,requestData:r,retrieveChangeToken:F,retrievePermMask:G,serviceWrapper:s,startWorkflow:N,updateListItem:J};return O}]),angular.module("angularPoint").factory("apDecodeService",["$q","_","apUtilityService","apQueueService","apConfig","apCacheService","apLookupFactory","apUserFactory","apFieldService","apXMLListAttributeTypes","apXMLFieldAttributeTypes",function(a,b,c,d,e,f,g,h,i,j,k){function l(a,c,d,e){var f={factory:a.factory,filter:"z:row",mapping:a.list.mapping,target:a.getCache()},g=b.extend({},f,e),h=$(d).SPFilterNode(g.filter),i=m(a,c,g.target);return n(h,i,g),g.target}function m(a,b,c){return function(d){d.getCache=function(){return c},d.getQuery=function(){return b};var e=new a.factory(d);return f.registerEntity(e,c)}}function n(a,c,d){var e={mapping:{},includeAllAttrs:!1,removeOws:!0},f=b.extend({},e,d),g=[];return b.each(a,function(a){var b=o(a,c,f);g.push(b)}),g}function o(a,c,d){var e={},f=a.attributes;return b.each(d.mapping,function(a){e[a.mappedName]=i.getDefaultValueForType(a.objectType)}),b.each(f,function(a){var b=a.name,c=d.mapping[b],f="undefined"!=typeof c?c.mappedName:d.removeOws?b.split("ows_")[1]:b,g="undefined"!=typeof c?c.objectType:void 0;(d.includeAllAttrs||void 0!==c)&&(e[f]=p(a.value,g,{entity:e,propertyName:f}))}),c(e)}function p(a,c,d){var e,f=b.unescape(a);switch(c){case"Attachments":e=q(f);break;case"Boolean":e=v(f);break;case"Calculated":e=C(f);break;case"datetime":case"DateTime":e=w(f);break;case"Lookup":e=z(f,d);break;case"User":e=x(f);break;case"LookupMulti":e=A(f,d);break;case"UserMulti":e=y(f);break;case"Integer":case"Counter":e=t(f);break;case"Number":case"Currency":case"float":case"Float":e=u(f);break;case"MultiChoice":e=B(f);break;case"JSON":e=r(f);break;case"Choice":case"HTML":case"Note":default:e=s(f)}return e}function q(a){if(isNaN(a))return B(a);var b=parseInt(a);return b>0?b:""}function r(a){if(a){var b=null;try{b=JSON.parse(a)}catch(c){console.error("Invalid JSON: ",a)}return b}return a}function s(a){return a}function t(a){return a?parseInt(a,10):a}function u(a){return a?parseFloat(a):a}function v(a){return"1"===a||"True"===a||"TRUE"===a}function w(a){if(a){var b=a.split(a.split("T")[0]!==a?"T":" "),c=b[0].split("-"),d=b[1].split(":"),e=d[2].split("Z");return new Date(c[0],c[1]-1,c[2],d[0],d[1],e[0])}return null}function x(a){return 0===a.length?null:h.create(a)}function y(a){if(0===a.length)return[];for(var b=[],c=a.split(";#"),d=0;d<c.length;d+=2){var e=x(c[d]+";#"+c[d+1]);b.push(e)}return b}function z(a,b){return 0===a.length?null:g.create(a,b)}function A(a,b){if(0===a.length)return[];for(var c=[],d=a.split(";#"),e=0;e<d.length;e+=2){var f=z(d[e]+";#"+d[e+1],b);c.push(f)}return c}function B(a){if(0===a.length)return[];for(var b=[],c=a.split(";#"),d=0;d<c.length;d++)0!==c[d].length&&b.push(c[d]);return b}function C(a){if(0===a.length)return null;var b=a.split(";#");return p(b[1],b[0])}function D(a,c,d){var e=c||{},f=d||{},g=a.attributes;return b.each(g,function(b,c){var d=g[c].name;e[d]=$(a).attr(d),f[d]&&(e[d]=p(e[d],f[d]))}),e}function E(a,b){return $(b).find("List").each(function(){D(this,a,j)}),a}function F(a,c){var d={};b.each(a,function(a){a.staticName&&(d[a.staticName]=a)});var e=$(c).SPFilterNode("Field");return b.each(e,function(a){var c=$(a).attr("StaticName"),e=d[c];if(e&&(D(a,e,k),"Choice"===e.objectType||"MultiChoice"===e.objectType)){e.Choices=[];var f=$(a).find("CHOICE");b.each(f,function(a){e.Choices.push($(a).text())}),e.Default=$(a).find("Default").text()}}),a}function G(a,c){var d=[],e=$(a).find("Version"),f=e.length;return b.each(e,function(a,b){var e={editor:p($(a).attr("Editor"),"User"),modified:p($(a).attr("Modified"),"DateTime"),version:f-b};e[c.mappedName]=p($(a).attr(c.staticName),c.objectType),d.unshift(e)}),d}function H(a){var c=null,d=["ErrorText","errorstring"];return b.each(d,function(b){$(a).find(b).each(function(){return c=$(this).text(),!1})}),c}return{checkResponseForErrors:H,extendFieldDefinitionsFromXML:F,extendListDefinitionFromXML:E,jsBoolean:v,jsCalc:C,jsChoiceMulti:B,jsDate:w,jsFloat:u,jsInt:t,jsLookup:z,jsLookupMulti:A,jsObject:r,jsString:s,jsUser:x,jsUserMulti:y,parseFieldVersions:G,parseStringValue:p,processListItems:l,xmlToJson:n}}]),angular.module("angularPoint").factory("apEncodeService",["_","apConfig","apUtilityService","SPServices",function(a,b,c,d){function e(b){var c="",d=";#";return b.length>0&&(c+=d,a.each(b,function(a){c+=a+d})),c}function f(b,c){var d=[];return a.each(b,function(b){a.has(c,b.mappedName)&&d.push(g(b,c[b.mappedName]))}),d}function g(a,b){var c=h(a.objectType,b);return[a.staticName,c]}function h(b,c){var f="";if(""!==c&&!a.isUndefined(c)&&!a.isNull(c))switch(b){case"Lookup":case"User":c.lookupId&&(f=c.lookupId+";#"+(c.lookupValue||""));break;case"LookupMulti":case"UserMulti":f=j(c,"lookupId");break;case"MultiChoice":f=e(c);break;case"Boolean":f=c?1:0;break;case"DateTime":f=i(c);break;case"JSON":f=JSON.stringify(c);break;case"HTML":case"Note":default:f=c}return a.isString(f)&&(f=d.encodeXml(f)),f}function i(b){if(!a.isDate(b)&&a.isString(b)&&3===b.split("-").length){var d=b.split("-");b=new Date(d[0],d[1]-1,d[2],0,0,0)}else if(!a.isDate(b))throw new Error("Invalid Date Provided: "+value.toString());var e=i,f="";return f+=b.getFullYear(),f+="-",f+=c.doubleDigit(b.getMonth()+1),f+="-",f+=c.doubleDigit(b.getDate()),f+="T",f+=c.doubleDigit(b.getHours()),f+=":",f+=c.doubleDigit(b.getMinutes()),f+=":",f+=c.doubleDigit(b.getSeconds()),f+="Z-",e.timeZone||(e.timeZone=(new Date).getTimezoneOffset()/60),f+=c.doubleDigit(e.timeZone),f+=":00"}function j(b,c,d){var e="",f=c||"lookupId",g=d||"lookupValue";return a.each(b,function(a,c){e+=a[f]+";#"+(a[g]||""),c<b.length&&(e+=";#")}),e}return{choiceMultiToString:e,createValuePair:g,generateValuePairs:f,stringifySharePointDate:i,stringifySharePointMultiSelect:j}}]),angular.module("angularPoint").factory("apExportService",["_","apUtilityService","apFormattedFieldValueService",function(a,b,c){function d(a,b,c){if(!a)return void console.error("apExportService.save"+b.toUpperCase()+": No data");var d=b.split(";")[0];c||(c="debug."+d),"json"===b&&"object"==typeof a&&(a=JSON.stringify(a,void 0,4));var e=new Blob([a],{type:"text/"+b}),f=document.createEvent("MouseEvents"),g=document.createElement("a");g.download=c,g.href=window.URL.createObjectURL(e),g.dataset.downloadurl=["text/"+b,g.download,g.href].join(":"),f.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),g.dispatchEvent(f)}function e(a,b){d(a,"json",b)}function f(a,b){d(a,"xml",b)}function g(a){var b=a;return b=b.replace(/[\u2018|\u2019|\u201A]/g,"'"),b=b.replace(/[\u201C|\u201D|\u201E]/g,'"'),b=b.replace(/\u2026/g,"..."),b=b.replace(/[\u2013|\u2014]/g,"-"),b=b.replace(/\u02C6/g,"^"),b=b.replace(/\u2039/g,"<"),b=b.replace(/\u203A/g,">"),b=b.replace(/[\u02DC|\u00A0]/g," ")}function h(b,c){var e="";a.each(b,function(b){a.each(b,function(a,b){var c=null===a?"":g(a);b>0&&(e+=","),c=c.replace(/"/g,'""'),e+='"'+c+'"'}),e+="\n"}),d(e,"csv;charset=utf-8;",c)}function i(d,e,f){var g={dateFormat:"json",delim:"; ",includeTitleRow:!0},h=a.extend({},g,f),i=[[]];return a.each(d,function(d,f){var g=[];a.each(e,function(e){var j=a.isString(e)?{field:e}:e,k=j.field.split("."),l=k[0];if(0===f&&h.includeTitleRow){var m=j.label?j.label:b.fromCamelCase(l);i[0].push(m)}var n="";if(a.isFunction(j.stringify))n=j.stringify(d[j.field]);else if(k.length>1)a.deepIn(d,j.field)&&(n=a.deepGet(d,j.field).toString());else{var o=d.getFieldDefinition(l);n=c.getFormattedFieldValue(d[j.field],o.objectType,h)}g.push(n)}),i.push(g)}),i}return{generateCSV:i,saveCSV:h,saveFile:d,saveJSON:e,saveXML:f}}]),angular.module("angularPoint").factory("apFieldService",["_","apUtilityService","apDefaultFields",function(a,b,c){function d(c){var d=this,e={readOnly:!1,objectType:"Text"};a.extend(d,e,c),d.displayName=d.displayName?d.displayName:b.fromCamelCase(d.mappedName),d.staticName=d.staticName||d.internalName}function e(){return{Text:{defaultValue:"",staticMock:"Test String",dynamicMock:i},Note:{defaultValue:"",staticMock:"This is a sentence.",dynamicMock:k},Boolean:{defaultValue:null,staticMock:!0,dynamicMock:g},Calculated:{defaultValue:null,staticMock:"float;#123.45",dynamicMock:h},Choice:{defaultValue:"",staticMock:"My Choice",dynamicMock:i},Counter:{defaultValue:null,staticMock:f(),dynamicMock:f},Currency:{defaultValue:null,staticMock:120.5,dynamicMock:l},DateTime:{defaultValue:null,staticMock:new Date(2014,5,4,11,33,25),dynamicMock:m},Integer:{defaultValue:null,staticMock:14,dynamicMock:n},JSON:{defaultValue:"",staticMock:[{id:1,title:"test"},{id:2}],dynamicMock:i},Lookup:{defaultValue:"",staticMock:{lookupId:49,lookupValue:"Static Lookup"},dynamicMock:q},LookupMulti:{defaultValue:[],staticMock:[{lookupId:50,lookupValue:"Static Multi 1"},{lookupId:51,lookupValue:"Static Multi 2"}],dynamicMock:s},Mask:{defaultValue:p(),staticMock:p(),dynamicMock:p},MultiChoice:{defaultValue:[],staticMock:["A Good Choice","A Bad Choice"],dynamicMock:j},User:{defaultValue:"",staticMock:{lookupId:52,lookupValue:"Static User"},dynamicMock:r},UserMulti:{defaultValue:[],staticMock:[{lookupId:53,lookupValue:"Static User 1"},{lookupId:54,lookupValue:"Static User 2"}],dynamicMock:t}}}function f(){return y++,y}function g(){return chance.bool()}function h(){return"float;#"+chance.floating({min:0,max:1e4})}function i(){return chance.word()+" "+chance.word()}function j(){var b=[];return a.times(a.random(1,4),function(){b.push(i())}),b}function k(){return chance.paragraph()}function l(){return parseInt(100*a.random(1e7,!0))/100}function m(){return chance.date()}function n(){return chance.integer()}function o(a){var b;switch(a){case"AddListItems":b="0x0000000000000002";break;case"EditListItems":b="0x0000000000000004";break;case"DeleteListItems":b="0x0000000000000008";break;case"ApproveItems":b="0x0000000000000010";break;case"FullMask":b="0x7FFFFFFFFFFFFFFF";break;case"ViewListItems":default:b="0x0000000000000001"}return b}function p(a){var b="FullMask";return a&&a.permissionLevel&&(b=a.permissionLevel),o(b)}function q(){return{lookupId:f(),lookupValue:chance.word()}}function r(){return{lookupId:f(),lookupValue:chance.name()}}function s(){var b=[];return a.each(a.random(10),function(){b.push(q())}),b}function t(){var b=[];return a.each(a.random(10),function(){b.push(r())}),b}function u(a){var b=e();return b[a]?b[a]:b.Text}function v(a){var b,c=u(a);return c&&(b=c.defaultValue),b}function w(b,c){var d,e=u(b);return e&&(d=a.isFunction(Chance)&&c&&!c.staticValue?e.dynamicMock(c):e.staticMock),d}function x(b){var e=function(a){var c=new d(a);b.fields.push(c),b.viewFields+='<FieldRef Name="'+c.staticName+'"/>',b.mapping["ows_"+c.staticName]={mappedName:c.mappedName,objectType:c.objectType}};b.viewFields+="<ViewFields>",a.each(c,function(a){e(a)}),a.each(b.customFields,function(a){e(a)}),b.viewFields+="</ViewFields>"}var y=0;return d.prototype.getDefinition=function(){return u(this.objectType)},d.prototype.getDefaultValueForType=function(){return v(this.objectType)},d.prototype.getMockData=function(a){return w(this.objectType,a)},{extendFieldDefinitions:x,getDefaultValueForType:v,getMockData:w,getDefinition:u,mockPermMask:p,resolveValueForEffectivePermMask:o}}]),function(){function a(a){function b(a,b,k){var l={delim:", ",dateFormat:"short"},m=_.extend({},l,k),n="";
if(a)switch(b){case"Boolean":n=g(a);break;case"Calculated":n=c(a);break;case"Lookup":case"User":n=f(a);break;case"DateTime":n=h(a,m.dateFormat);break;case"Integer":case"Number":case"Float":case"Counter":n=d(a);break;case"Currency":n=e(a);break;case"MultiChoice":n=i(a,m.delim);break;case"UserMulti":case"LookupMulti":n=j(a,m.delim);break;default:n=a}return n}function c(a){return 0===a.length?"":_.isNumber(a)?b(a,"Number"):_.isDate(a)?b(a,"DateTime"):b(a,"Text")}function d(a){var b="";return _.isNumber(a)&&(b=a.toString()),b}function e(b){return a("currency")(b,"$")}function f(a){var b="";return a&&a.lookupValue&&(b=a.lookupValue),b}function g(a){var b="";return _.isBoolean(a)&&(b=a.toString()),b}function h(b,c){var d="";return _.isDate(b)&&(d="json"===c?b.toJSON():a("date")(b,c)),d}function i(a,b){var c="",d=b||"; ";return _.each(a,function(a,b){b>0&&(c+=d),c+=a}),c}function j(a,b){var c="",d=b||"; ";return _.each(a,function(a,b){b>0&&(c+=d),c+=f(a)}),c}var k={getFormattedFieldValue:b,stringifyBoolean:g,stringifyCalc:c,stringifyCurrency:e,stringifyDate:h,stringifyLookup:f,stringifyMultiChoice:i,stringifyMultiLookup:j,stringifyNumber:d};return k}angular.module("angularPoint").factory("apFormattedFieldValueService",a),a.$inject=["$filter"]}(),angular.module("angularPoint").factory("apQueueService",function(){function a(){return g.count++,e(),g.count}function b(){return g.count>0?(g.count--,e(),g.count):void 0}function c(){return g.count=0,e(),g.count}function d(a){f.push(a)}function e(){_.each(f,function(a){a(g.count)})}var f=[],g={count:0,decrease:b,increase:a,notifyObservers:e,registerObserverCallback:d,reset:c};return g}),angular.module("angularPoint").factory("SPServices",["apWebServiceOperationConstants","apWebServiceService",function(a,b){function c(){return{header:"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>",footer:"</soap:Body></soap:Envelope>",payload:""}}function d(d){function i(a,b){var c;for(c=0;c<b.length;c++)"string"==typeof b[c]?p.payload+=e(b[c],a[b[c]]):_.isArray(b[c])&&2===b[c].length?p.payload+=e(b[c][0],a[b[c][1]]):"object"==typeof b[c]&&void 0!==b[c].sendNull?p.payload+=void 0===a[b[c].name]||0===a[b[c].name].length?"":e(b[c].name,a[b[c].name]):h(a.operation,"paramArray["+c+"]: "+b[c],"Invalid paramArray element passed to addToPayload()")}function m(a,b){var c=b.substring(8);return a.opheader=a.opheader.replace(b,c),a.opfooter=a.opfooter.replace(b,c),a}var n=[["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],["listItemID","ID"]];_.each(n,function(a){d[a[0]]&&!d[a[1]]&&(d[a[1]]=d[a[0]])});var o,p=new c,q=_.extend({},l,d);_.each(k,function(a){_.isString(q[a])&&(q[a]=f(q[a]))});var r=a[q.operation][0];switch(p.opheader="<"+q.operation+" xmlns='"+b.xmlns(r)+"' >",o=b.action(r),o+=q.operation,p.opfooter="</"+q.operation+">",q.operation){case"GetAlerts":break;case"DeleteAlerts":for(p.payload+="<IDs>",j=0;j<q.IDs.length;j++)p.payload+=e("string",q.IDs[j]);p.payload+="</IDs>";break;case"Mode":break;case"Login":i(q,["username","password"]);break;case"CopyIntoItems":for(i(q,["SourceUrl"]),p.payload+="<DestinationUrls>",j=0;j<q.DestinationUrls.length;j++)p.payload+=e("string",q.DestinationUrls[j]);p.payload+="</DestinationUrls>",i(q,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":for(i(q,["SourceUrl"]),p.payload+="<DestinationUrls>",j=0;j<q.DestinationUrls.length;j++)p.payload+=e("string",q.DestinationUrls[j]);p.payload+="</DestinationUrls>";break;case"GetItem":i(q,["Url","Fields","Stream"]);break;case"GetForm":i(q,["listName","formUrl"]);break;case"GetFormCollection":i(q,["listName"]);break;case"AddAttachment":i(q,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":i(q,["listName","message"]);break;case"AddList":i(q,["listName","description","templateID"]);break;case"AddListFromFeature":i(q,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":i(q,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":i(q,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":i(q,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":i(q,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":i(q,["listName","listItemID","url"]);break;case"DeleteContentType":i(q,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":i(q,["listName","contentTypeId","documentUri"]);break;case"DeleteList":i(q,["listName"]);break;case"GetAttachmentCollection":i(q,["listName",["listItemID","ID"]]);break;case"GetList":i(q,["listName"]);break;case"GetListAndView":i(q,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":i(q,["listName","contentTypeId"]);break;case"GetListContentTypes":i(q,["listName"]);break;case"GetListItems":i(q,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":i(q,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":i(q,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:!1},{name:"contains",sendNull:!1}]);break;case"GetVersionCollection":i(q,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":i(q,["pageUrl"]);break;case"UpdateContentType":i(q,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":i(q,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":i(q,["listName","contentTypeId","newDocument"]);break;case"UpdateList":i(q,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":if(i(q,["listName"]),"undefined"!=typeof q.updates&&q.updates.length>0)i(q,["updates"]);else{for(p.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+q.batchCmd+"'>",j=0;j<q.valuePairs.length;j++)p.payload+="<Field Name='"+q.valuePairs[j][0]+"'>"+g(q.valuePairs[j][1])+"</Field>";"New"!==q.batchCmd&&(p.payload+="<Field Name='ID'>"+q.ID+"</Field>"),p.payload+="</Method></Batch></updates>"}break;case"AddMeeting":i(q,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":i(q,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":i(q,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":i(q,["title"]);break;case"ResolvePrincipals":i(q,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":i(q,["searchText","maxResults","principalType"]);break;case"AddPermission":i(q,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":i(q,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":i(q,["objectName","objectType"]);break;case"RemovePermission":i(q,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":i(q,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":i(q,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":p.opheader="<"+q.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",o="http://microsoft.com/webservices/OfficeServer/QueryService/"+q.operation;break;case"GetQuerySuggestions":p.opheader="<"+q.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",o="http://microsoft.com/webservices/OfficeServer/QueryService/"+q.operation,p.payload+=e("queryXml",f(q.queryXml));break;case"GetSearchMetadata":p.opheader="<"+q.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",o="http://microsoft.com/webservices/OfficeServer/QueryService/"+q.operation;break;case"Query":p.payload+=e("queryXml",f(q.queryXml));break;case"QueryEx":p.opheader="<"+q.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>",o="http://microsoft.com/webservices/OfficeServer/QueryService/"+q.operation,p.payload+=e("queryXml",f(q.queryXml));break;case"Registration":p.payload+=e("registrationXml",f(q.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":i(q,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":i(q,["strFolderUrl"]);break;case"GetAttachments":i(q,["strListName","strItemId"]);break;case"SiteDataGetList":i(q,["strListName"]),p=m(p,q.operation);break;case"SiteDataGetListCollection":p=m(p,q.operation);break;case"SiteDataGetSite":p=m(p,q.operation);break;case"SiteDataGetSiteUrl":i(q,["Url"]),p=m(p,q.operation);break;case"SiteDataGetWeb":p=m(p,q.operation);break;case"CreateWeb":i(q,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":i(q,["url"]);break;case"GetSite":i(q,["SiteUrl"]);break;case"GetSiteTemplates":i(q,["LCID","TemplateList"]);break;case"AddComment":i(q,["url","comment","isHighPriority","title"]);break;case"AddTag":i(q,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":i(q,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":i(q,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":i(q,["userAccountName","url"]);break;case"CountCommentsOnUrl":i(q,["url"]);break;case"CountRatingsOnUrl":i(q,["url"]);break;case"CountTagsOfUser":i(q,["userAccountName"]);break;case"DeleteComment":i(q,["url","lastModifiedTime"]);break;case"DeleteRating":i(q,["url"]);break;case"DeleteTag":i(q,["url","termID"]);break;case"DeleteTagByKeyword":i(q,["url","keyword"]);break;case"DeleteTags":i(q,["url"]);break;case"GetAllTagTerms":i(q,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":i(q,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":i(q,["termID"]);break;case"GetAllTagUrlsByKeyword":i(q,["keyword"]);break;case"GetCommentsOfUser":i(q,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":i(q,["userAccountName","url"]);break;case"GetCommentsOnUrl":i(q,["url","maximumItemsToReturn","startIndex"]),"undefined"!=typeof q.excludeItemsTime&&q.excludeItemsTime.length>0&&(p.payload+=e("excludeItemsTime",q.excludeItemsTime));break;case"GetRatingAverageOnUrl":i(q,["url"]);break;case"GetRatingOfUserOnUrl":i(q,["userAccountName","url"]);break;case"GetRatingOnUrl":i(q,["url"]);break;case"GetRatingsOfUser":i(q,["userAccountName"]);break;case"GetRatingsOnUrl":i(q,["url"]);break;case"GetSocialDataForFullReplication":i(q,["userAccountName"]);break;case"GetTags":i(q,["url"]);break;case"GetTagsOfUser":i(q,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":i(q,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":i(q,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":i(q,["url","maximumItemsToReturn"]);break;case"GetTagUrls":i(q,["termID"]);break;case"GetTagUrlsByKeyword":i(q,["keyword"]);break;case"GetTagUrlsOfUser":i(q,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":i(q,["keyword","userAccountName"]);break;case"SetRating":i(q,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":i(q,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":i(q,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":i(q,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":i(q,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":i(q,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":i(q,["termIds","lcid"]);break;case"GetTermsByLabel":i(q,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":i(q,["sharedServiceId","termSetId","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":i(q,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":i(q,["groupName","roleName"]);break;case"AddRole":i(q,["roleName","description","permissionMask"]);break;case"AddRoleDef":i(q,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":i(q,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":i(q,["roleName","usersInfoXml"]);break;case"AddUserToGroup":i(q,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":i(q,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":i(q,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":i(q,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":i(q,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":i(q,["groupName"]);break;case"GetRoleCollection":i(q,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":i(q,["groupName"]);break;case"GetRoleCollectionFromUser":i(q,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":i(q,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":i(q,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":i(q,["groupName"]);break;case"GetUserCollectionFromRole":i(q,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":i(q,["userLoginName"]);break;case"GetUserLoginFromEmail":i(q,["emailXml"]);break;case"RemoveGroup":i(q,["groupName"]);break;case"RemoveGroupFromRole":i(q,["roleName","groupName"]);break;case"RemoveRole":i(q,["roleName"]);break;case"RemoveUserCollectionFromGroup":i(q,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":i(q,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":i(q,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":i(q,["groupName","userLoginName"]);break;case"RemoveUserFromRole":i(q,["roleName","userLoginName"]);break;case"RemoveUserFromSite":i(q,["userLoginName"]);break;case"RemoveUserFromWeb":i(q,["userLoginName"]);break;case"UpdateGroupInfo":i(q,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":i(q,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":i(q,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":i(q,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":i(q,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":i(q,["accountName","name","url","group","privacy"]);break;case"AddMembership":i(q,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":i(q,["accountName","name","url"]);break;case"CreateMemberGroup":i(q,["membershipInfo"]);break;case"CreateUserProfileByAccountName":i(q,["accountName"]);break;case"GetCommonColleagues":i(q,["accountName"]);break;case"GetCommonManager":i(q,["accountName"]);break;case"GetCommonMemberships":i(q,["accountName"]);break;case"GetInCommon":i(q,["accountName"]);break;case"GetPropertyChoiceList":i(q,["propertyName"]);break;case"GetUserColleagues":i(q,["accountName"]);break;case"GetUserLinks":i(q,["accountName"]);break;case"GetUserMemberships":i(q,["accountName"]);break;case"GetUserPinnedLinks":i(q,["accountName"]);break;case"GetUserProfileByGuid":i(q,["guid"]);break;case"GetUserProfileByIndex":i(q,["index"]);break;case"GetUserProfileByName":"undefined"!=typeof q.accountName&&q.accountName.length>0?i(q,[["AccountName","accountName"]]):i(q,["AccountName"]);break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":i(q,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":i(q,["accountName","newData"]);break;case"RemoveAllColleagues":i(q,["accountName"]);break;case"RemoveAllLinks":i(q,["accountName"]);break;case"RemoveAllMemberships":i(q,["accountName"]);break;case"RemoveAllPinnedLinks":i(q,["accountName"]);break;case"RemoveColleague":i(q,["accountName","colleagueAccountName"]);break;case"RemoveLink":i(q,["accountName","id"]);break;case"RemoveMembership":i(q,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":i(q,["accountName","id"]);break;case"UpdateColleaguePrivacy":i(q,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":i(q,["accountName","data"]);break;case"UpdateMembershipPrivacy":i(q,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":i(q,["accountName","data"]);break;case"DeleteAllVersions":i(q,["fileName"]);break;case"DeleteVersion":i(q,["fileName","fileVersion"]);break;case"GetVersions":i(q,["fileName"]);break;case"RestoreVersion":i(q,["fileName","fileVersion"]);break;case"AddView":i(q,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":i(q,["listName","viewName"]);break;case"GetView":i(q,["listName","viewName"]);break;case"GetViewCollection":i(q,["listName"]);break;case"GetViewHtml":i(q,["listName","viewName"]);break;case"UpdateView":i(q,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":i(q,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":i(q,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":i(q,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"GetWebPart2":i(q,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":i(q,["documentName","behavior"]);break;case"GetWebPartProperties":i(q,["pageUrl","storage"]);break;case"GetWebPartProperties2":i(q,["pageUrl","storage","behavior"]);break;case"Webs.CreateContentType":i(q,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":i(q,["webUrl"]);break;case"GetContentType":i(q,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":i(q,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":i(q,["objectUrl"]);break;case"GetWeb":i(q,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":i(q,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":i(q,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":i(q,[["pageUrl","pageURL"]]);break;case"AlterToDo":i(q,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":i(q,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":i(q,["item"]);break;case"GetToDosForItem":i(q,["item"]);break;case"GetWorkflowDataForItem":i(q,["item"]);break;case"GetWorkflowTaskData":i(q,["item","listId","taskId"]);break;case"StartWorkflow":i(q,["item","templateId","workflowParameters"])}var s=p.header+p.opheader+p.payload+p.opfooter+p.footer,t=a[q.operation][1]?o:!1;return{msg:s,SOAPEnvelope:p,SOAPAction:t}}function e(a,b){var c="undefined"!=typeof b?b:"";return"<"+a+">"+c+"</"+a+">"}function f(a){return a.replace(/([\&"<>])/g,function(a,b){return n[b]})}function g(a){return"string"==typeof a?a.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;"):a}function h(a){console.error(a)}var i="http://schemas.microsoft.com/sharepoint",j=0,k=["listName","description"],l={operation:"",webURL:"",makeViewDefault:!1,CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuePairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:!0,nonGregorian:!1,fClaim:!1,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:!1,isPrivate:!1,rating:1,maxResults:10,principalType:"User",async:!0,completefunc:null},m={defaults:l,encodeXml:f,generateXMLComponents:d,SCHEMASharePoint:i,SOAPEnvelope:new c};$.fn.SPFilterNode=function(a){return this.find("*").filter(function(){return this.nodeName===a})};var n={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};return $.expr[":"].regex=function(a,b,c){var d=c[3].split(","),e=/^(data|css):/,f={method:d[0].match(e)?d[0].split(":")[0]:"attr",property:d.shift().replace(e,"")},g="ig",h=new RegExp(d.join("").replace(/^\s+|\s+$/g,""),g);return h.test(jQuery(a)[f.method](f.property))},m}]),angular.module("angularPoint").factory("apUtilityService",["$q","_","apConfig","$timeout",function(a,b,c,d){function e(a){return"number"==typeof a?a>9?a.toString():"0"+a:e(parseInt(a))}function f(a){var b=a.getFullYear(),c=a.getMonth()+1,d=a.getDate();return parseInt(b+e(c)+e(d))}function g(a,b,c){if(!a||!b)return!1;c=c||new Date;var d=f(a),e=f(b),g=f(c);return g>=d&&e>=g}function h(b,c,e,f,g){function h(){j++;for(var a=+new Date,g=l;i>l&&k>l-g&&new Date-a<100;)c.call(e,b[l],l,j),l+=1;i>l?d(h,f):m.resolve(b)}var i=b.length,j=0,k=g||i,f=f||25,l=0,m=a.defer();return h(),m.promise}function i(a){var c={};return c.ViewListItems=(1&a)>0,c.AddListItems=(2&a)>0,c.EditListItems=(4&a)>0,c.DeleteListItems=(8&a)>0,c.ApproveItems=(16&a)>0,c.OpenItems=(32&a)>0,c.ViewVersions=(64&a)>0,c.DeleteVersions=(128&a)>0,c.CancelCheckout=(256&a)>0,c.PersonalViews=(512&a)>0,c.ManageLists=(2048&a)>0,c.ViewFormPages=(4096&a)>0,c.Open=(65536&a)>0,c.ViewPages=(131072&a)>0,c.AddAndCustomizePages=(262144&a)>0,c.ApplyThemeAndBorder=(524288&a)>0,c.ApplyStyleSheets=(1048576&a)>0,c.ViewUsageData=(2097152&a)>0,c.CreateSSCSite=(4194314&a)>0,c.ManageSubwebs=(8388608&a)>0,c.CreateGroups=(16777216&a)>0,c.ManagePermissions=(33554432&a)>0,c.BrowseDirectories=(67108864&a)>0,c.BrowseUserInfo=(134217728&a)>0,c.AddDelPrivateWebParts=(268435456&a)>0,c.UpdatePersonalWebParts=(536870912&a)>0,c.ManageWeb=(1073741824&a)>0,c.UseRemoteAPIs=(137438953472&a)>0,c.ManageAlerts=(274877906944&a)>0,c.CreateAlerts=(549755813888&a)>0,c.EditMyUserInfo=(1099511627776&a)>0,c.EnumeratePermissions=(0x4000000000000000&a)>0,c.FullMask=0x8000000000000000==a,c.FullMask&&b.each(c,function(a,b){c[b]=!0}),c}function j(a){var b=null,c={EmptyMask:"0x0000000000000000",FullMask:"0x7FFFFFFFFFFFFFFF",ViewListItems:"0x0000000000000001",AddListItems:"",EditListItems:"0x0000000000000004",DeleteListItems:"0x0000000000000008",ApproveItems:"0x0000000000000010",OpenItems:"0x0000000000000020",ViewVersions:"0x0000000000000040",DeleteVersions:"0x0000000000000080",CancelCheckout:"0x0000000000000100",ManagePersonalViews:"0x0000000000000200",ManageLists:"0x0000000000000800",ViewFormPages:"0x0000000000001000",Open:"0x0000000000010000",ViewPages:"0x0000000000020000",AddAndCustomizePages:"0x0000000000040000",ApplyThemeAndBorder:"0x0000000000080000",ApplyStyleSheets:"0x0000000000100000",ViewUsageData:"0x0000000000200000",CreateSSCSite:"0x0000000000400000",ManageSubwebs:"0x0000000000800000",CreateGroups:"0x0000000001000000",ManagePermissions:"0x0000000002000000",BrowseDirectories:"0x0000000004000000",BrowseUserInfo:"0x0000000008000000",AddDelPrivateWebParts:"0x0000000010000000",UpdatePersonalWebParts:"0x0000000020000000",ManageWeb:"0x0000000040000000",UseClientIntegration:"0x0000001000000000",UseRemoteAPIs:"0x0000002000000000",ManageAlerts:"0x0000004000000000",CreateAlerts:"0x0000008000000000",EditMyUserInfo:"0x0000010000000000",EnumeratePermissions:"0x4000000000000000"};return c[a]&&(b=c[a]),b}function k(a){return a.replace(/(?:^\w|[A-Z]|\b\w)/g,function(a,b){return 0==b?a.toLowerCase():a.toUpperCase()}).replace(/\s+/g,"")}function l(a){return a.replace(/([A-Z])/g," $1").replace(/^./,function(a){return a.toUpperCase()})}function m(a){var b=a.split(";#");this.id=parseInt(b[0],10),this.value=b[1]}function n(a){var c;return b.isObject(a)?c=o(a).replace(/\s+/g," "):b.isString(a)&&(c=a),c}function o(a){var b;return b="undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(a):a.xml}function p(){}return b.mixin({isDefined:function(a){return!b.isUndefined(a)},isGuid:function(a){return"string"==typeof a&&/[a-fA-F\d]{8}-(?:[a-fA-F\d]{4}-){3}[a-fA-F\d]{12}/.test(a)}}),{batchProcess:h,convertEffectivePermMask:j,dateWithinRange:g,doubleDigit:e,fromCamelCase:l,registerChange:p,resolvePermissions:i,SplitIndex:m,stringifyXML:n,toCamelCase:k,yyyymmdd:f}}]),angular.module("angularPoint").factory("apWebServiceService",function(){function a(a){return d[a]?d[a].action:c+"/soap/"}function b(a){return d[a]?d[a].xmlns:c+"/soap/"}var c="http://schemas.microsoft.com/sharepoint",d={Alerts:{action:c+"/soap/2002/1/alerts/",xmlns:c+"/soap/2002/1/alerts/"},Meetings:{action:c+"/soap/meetings/",xmlns:c+"/soap/meetings/"},Permissions:{action:c+"/soap/directory/",xmlns:c+"/soap/directory/"},PublishedLinksService:{action:"http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/",xmlns:"http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/"},Search:{action:"urn:Microsoft.Search/",xmlns:"urn:Microsoft.Search"},SharePointDiagnostics:{action:"http://schemas.microsoft.com/sharepoint/diagnostics/",xmlns:c+"/diagnostics/"},SocialDataService:{action:"http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/",xmlns:"http://microsoft.com/webservices/SharePointPortalServer/SocialDataService"},SpellCheck:{action:"http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck",xmlns:"http://schemas.microsoft.com/sharepoint/publishing/spelling/"},TaxonomyClientService:{action:c+"/taxonomy/soap/",xmlns:c+"/taxonomy/soap/"},usergroup:{action:c+"/soap/directory/",xmlns:c+"/soap/directory/"},UserProfileService:{action:"http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/",xmlns:"http://microsoft.com/webservices/SharePointPortalServer/UserProfileService"},WebPartPages:{action:"http://microsoft.com/sharepoint/webpartpages/",xmlns:"http://microsoft.com/sharepoint/webpartpages"},Workflow:{action:c+"/soap/workflow/",xmlns:c+"/soap/workflow/"}},e=["Alerts","Authentication","Copy","Forms","Lists","Meetings","People","Permissions","PublishedLinksService","Search","SharePointDiagnostics","SiteData","Sites","SocialDataService","SpellCheck","TaxonomyClientService","usergroup","UserProfileService","Versions","Views","WebPartPages","Webs","Workflow"];return{action:a,webServices:e,xmlns:b}}),angular.module("angularPoint").service("apXMLToJSONService",["_","apDecodeService",function(a,b){return function(c,d){var e={mapping:{},includeAllAttrs:!1,removeOws:!0,sparse:!1},f=a.extend({},e,d),g=[];return a.each(c,function(c){var d={},e=c.attributes;f.sparse||a.each(f.mapping,function(a){d[a.mappedName]=""}),a.each(e,function(a){var c=a.name,e=f.mapping[c],g="undefined"!=typeof e?e.mappedName:f.removeOws?c.split("ows_")[1]:c,h="undefined"!=typeof e?e.objectType:void 0;(f.includeAllAttrs||void 0!==e)&&(d[g]=b.parseStringValue(a.value,h))}),g.push(d)}),g}}]),angular.module("angularPoint").factory("apCamlFactory",["_",function(a){function b(a,b){var c;switch(a.objectType){case"HTML":case"JSON":c='<Contains><FieldRef Name="'+a.staticName+'" /><Value Type="Text"><![CDATA['+b+"]]></Value></Contains>";break;default:c='<Contains><FieldRef Name="'+a.staticName+'" /><Value Type="Text">'+b+"</Value></Contains>"}return c}function c(b,c){var d="",e="";return a.each(b,function(a,f){f<b.length-1&&(d+="<"+c+">",e="</"+c+">"+e),d+=a}),d+e}function d(d,e){var f=[];return a.each(d,function(a){f.push(b(a,e))}),c(f,"And")}return{camlContainsQuery:d,chainCamlSelects:c,createCamlContainsSelector:b}}]),angular.module("angularPoint").factory("apIndexedCacheFactory",["_",function(a){function b(b){var c=this;b&&a.extend(c,b)}function c(b){var c=this;if(!a.isObject(b)||!b.id)throw new Error("A valid entity wasn't found: ",b);c[b.id]||(c[b.id]=b)}function d(){var b=this;a.each(b,function(a,c){delete b[c]})}function e(){var b=this;return a.keys(b)}function f(a){var b=this,c=b.keys();return b[c[a]]}function g(){var a=this;return a.nthEntity(0)}function h(){var a=this,b=a.keys();return a[b[b.length-1]]}function i(){var a=this;return a.keys().length}function j(b){var c=this;a.isObject&&b.id&&c[b.id]?delete c[b.id]:a.isNumber(b)&&delete c[b]}function k(){var b=this;return a.toArray(b)}function l(){return new b}return b.prototype={addEntity:c,clear:d,count:i,first:g,keys:e,last:h,nthEntity:f,removeEntity:j,toArray:k},{create:l,IndexedCache:b}}]),angular.module("angularPoint").factory("apListFactory",["_","apConfig","apFieldService",function(a,b,c){function d(d){var e=this,f={viewFields:"",customFields:[],isReady:!1,fields:[],guid:"",mapping:{},title:"",webURL:b.defaultUrl};a.extend(e,f,d),e.environments=e.environments||{production:e.guid},c.extendFieldDefinitions(e)}function e(){var c=this;if(a.isString(c.environments[b.environment]))return c.environments[b.environment];throw new Error("There isn't a valid environment definition for apConfig.environment="+b.environment+'  Please confirm that the list "'+c.title+'" has the necessary environmental configuration.')}function f(){var a=this;return a.WebFullUrl?a.WebFullUrl:a.webURL}d.prototype.getListId=e,d.prototype.identifyWebURL=f;var g=function(a){return new d(a)};return{create:g,List:d}}]),angular.module("angularPoint").factory("apListItemFactory",["$q","_","apCacheService","apDataService","apEncodeService","apUtilityService","apFormattedFieldValueService","apConfig",function(a,b,c,d,e,f,g,h){function i(){}function j(b){var c=this,e=c.getModel(),g=a.defer();return c.id?(d.updateListItem(e,c,b).then(function(a){g.resolve(a),f.registerChange(e)}),g.promise):e.addNewItem(c,b)}function k(c,g){var h=this,i=h.getModel(),j=a.defer(),k=[],l=b.isString(c)?[c]:c;b.each(l,function(a){var c=b.findWhere(i.list.customFields,{mappedName:a});c&&k.push(c)});var m=e.generateValuePairs(k,h),n={buildValuePairs:!1,valuePairs:m},o=b.extend({},n,g);return d.updateListItem(i,h,o).then(function(a){j.resolve(a),f.registerChange(i)}),j.promise}function l(b){var c=this,e=c.getModel(),g=a.defer();return d.deleteListItem(e,c,b).then(function(a){g.resolve(a),f.registerChange(e)}),g.promise}function m(a,d){var e=this;if(b.isUndefined(a))throw new Error("A field name is required.",a);if(b.isEmpty(e[a]))return"";var f=e.getModel(),g=f.getFieldDefinition(a);if(g&&g.List){var h=d||e[a].lookupId;return c.getCachedEntity(g.List,h)}throw new Error("This isn't a valid Lookup field or the field definitions need to be extended before we can complete this request.",a,d)}function n(a,b){var c=this,d=c.getFieldDefinition(a);if(!d)throw"A field definition for a field named "+a+" wasn't found.";return g.getFormattedFieldValue(c[a],d.objectType,b)}function o(a){var b=this,c=b.getModel();return c.validateEntity(b,a)}function p(a){var b=this;return b.getModel().getFieldDefinition(a)}function q(){var a=this;return d.getAvailableWorkflows(a.fileRef.lookupValue)}function r(c){function e(){d.startWorkflow(c).then(function(a){g.resolve(a)})}var f=this,g=a.defer();if(c.fileRef=f.fileRef.lookupValue,!c.templateId&&!c.workflowName)throw"Either a templateId or workflowName is required to initiate a workflow.";return c.templateId?e():f.getAvailableWorkflows().then(function(a){var d=b.findWhere(a,{name:c.workflowName});if(!d)throw"A workflow with the specified name wasn't found.";c.templateId=d.templateId,e()}),g.promise}function s(){var a=this;return d.getCollection({operation:"GetAttachmentCollection",listName:a.getModel().list.getListId(),webURL:a.getModel().list.webURL,ID:a.id,filterNode:"Attachment"})
}function t(a){var b=this;return d.deleteAttachment({listItemID:b.id,url:a,listName:b.getModel().list.getListId()})}function u(){var a=this;return f.resolvePermissions(a.permMask)}function v(c){var e=a.defer(),f=[],g=this,i=g.getModel(),j=function(a){var c=b.findWhere(i.list.fields,{mappedName:a}),e={operation:"GetVersionCollection",strlistID:i.list.getListId(),strlistItemID:g.id,strFieldName:c.staticName};h.defaultUrl&&(e.webURL=h.defaultUrl),f.push(d.getFieldVersionHistory(e,c))};if(c)b.isString(c)&&(c=[c]);else{var k=b.where(i.list.fields,{readOnly:!1});c=[],b.each(k,function(a){c.push(a.mappedName)})}return b.each(c,function(a){j(a)}),a.all(f).then(function(a){var c={};b.each(a,function(a){b.each(a,function(a){c[a.modified.toJSON()]=c[a.modified.toJSON()]||{},b.extend(c[a.modified.toJSON()],a)})});var d=[];b.each(c,function(a,b){a.version=b,d.push(a)}),e.resolve(d)}),e.promise}i.prototype={constructor:i,deleteAttachment:t,deleteItem:l,getAttachmentCollection:s,getAvailableWorkflows:q,getFieldDefinition:p,getFieldVersionHistory:v,getFormattedValue:n,getLookupReference:m,resolvePermissions:u,saveChanges:j,saveFields:k,startWorkflow:r,validateEntity:o};var w=function(a){var c=this;b.extend(c,a)},x=function(){return new i},y=function(){return new w};return{create:x,createGenericFactory:y,ListItem:i,StandardListItem:w}}]),angular.module("angularPoint").factory("apLookupFactory",["_","$q","apUtilityService",function(a,b,c){function d(a){var b=this,d=new c.SplitIndex(a);b.lookupId=d.id,b.lookupValue=d.value||""}var e=function(a,b){return new d(a,b)};return{create:e,Lookup:d}}]),angular.module("angularPoint").factory("apModelFactory",["_","apCacheService","apDataService","apListFactory","apListItemFactory","apQueryFactory","apUtilityService","apFieldService","apConfig","apIndexedCacheFactory","apDecodeService","$q","toastr",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(c){var f=this,g={data:[],factory:e.createGenericFactory(),fieldDefinitionsExtended:!1,lastServerUpdate:null,queries:{}};return a.extend(f,g,c),f.list=d.create(f.list),f.factory.prototype=e.create(),f.factory.constructor=e.ListItem,f.factory.prototype.getModel=function(){return f},f.factory.prototype.getList=function(){return f.list},f.factory.prototype.getList=function(){return f.list.getListId()},b.registerModel(f),f.registerQuery({name:"getAllListItems",operation:"GetListItems"}),f.searchLocalCache=o,f}function o(b,c){var d,e,f,g=this,h={propertyPath:"id",localCache:g.getCache(),cacheName:"main",rebuildIndex:!1},i=a.extend({},h,c);if("id"===i.propertyPath)e=i.localCache;else{g._cachedIndexes=g._cachedIndexes||{},g._cachedIndexes[i.cacheName]=g._cachedIndexes[i.cacheName]||{},d=g._cachedIndexes[i.cacheName];var j=i.propertyPath.split(".");a.each(j,function(a){d[a]=d[a]||{},d=d[a]}),(!a.isNumber(d.count)||d.count!==i.localCache.count()||i.rebuildIndex)&&(d.indexedCache=p(i.localCache,i.propertyPath),d.count=i.localCache.count(),d.buildCount=d.buildCount||0,d.buildCount++),e=d.indexedCache}return a.isArray(b)?(f=[],a.each(b,function(a){f.push(e[a])})):f=e[b],f}function p(b,c){function d(){}function e(b){var d=this,e=a.deepGet(b,c);e&&(d[e]=b)}d.prototype=j.IndexedCache,d.prototype.addEntity=e;var f=new d;return a.each(b,function(a){f.addEntity(a)}),f}function q(){var a=this;return c.executeQuery(a,a.queries.getAllListItems)}function r(b,c){var d=l.defer(),e=this,f="GetListItemById-"+b;if(!e.getQuery(f)){var g={name:f,operation:"GetListItems",CAMLRowLimit:1,CAMLQuery:'<Query> <Where>   <Eq>     <FieldRef Name="ID"/>     <Value Type="Number">'+b+"</Value>   </Eq> </Where></Query>"},h=a.extend({},g,c);e.registerQuery(h)}return e.executeQuery(f).then(function(a){d.resolve(a.first())},function(a){d.reject(a)}),d.promise}function s(a,b){var d=this,e=l.defer();return c.createListItem(d,a,b).then(function(a){e.resolve(a),g.registerChange(d)}),e.promise}function t(b){var c=this,d={name:H};return b=a.extend({},d,b),c.queries[b.name]=f.create(b,c),c.queries[b.name]}function u(b){var c,d=this;return c=a.isObject(d.queries[b])?d.queries[b]:a.isObject(d.queries[H])&&!b?d.queries[H]:void 0}function v(b){var c=this;return a.findWhere(c.list.fields,{mappedName:b})}function w(a){var b,c,d=this;return b=d.getQuery(a),b&&b.indexedCache&&(c=b.indexedCache),c}function x(a){var c=this;return b.getCachedEntity(c.list.getListId(),a)}function y(){var a=this;return b.getCachedEntities(a.list.getListId())}function z(a,b){var c=this,d=c.getQuery(a);return d?d.execute(b):void 0}function A(b){var d=this,e=l.defer(),f={listName:d.list.getListId()};if(!d.fieldDefinitionsExtended&&!d.deferredListDefinition){d.deferredListDefinition=e.promise;var g=a.extend({},f,b);c.getList(g).then(function(a){k.extendListDefinitionFromXML(d.list,a),k.extendFieldDefinitionsFromXML(d.list.fields,a),d.fieldDefinitionsExtended=!0,e.resolve(d)})}return d.deferredListDefinition}function B(){var b=this;return a.isDate(b.lastServerUpdate)}function C(b){var c=this,d={};a.each(c.list.customFields,function(a){a.readOnly||(d[a.mappedName]=h.getDefaultValueForType(a.objectType))});var e=a.extend({},d,b);return new c.factory(e)}function D(b){var c=[],d=this,e={quantity:10,staticValue:!1,permissionLevel:"FullMask"},f=a.extend({},e,b);return a.times(f.quantity,function(b){var e={};a.each(d.list.fields,function(a){e[a.mappedName]=a.getMockData(f)}),e.id=b+1,c.push(new d.factory(e))}),c}function E(b,c){var d=!0,e=this,f={toast:!0},g=a.extend({},f,c),h=function(b){return a.isObject(b)&&a.isNumber(b.lookupId)};return a.each(e.list.customFields,function(c){var e=b[c.mappedName],f='"'+c.objectType+'" value.';if((c.required||c.Required)&&d){switch(c.objectType){case"Boolean":d=a.isBoolean(e);break;case"DateTime":d=a.isDate(e);break;case"Lookup":case"User":d=h(e);break;case"LookupMulti":case"UserMulti":d=a.isArray(e)&&e.length>0,d&&a.each(e,function(a){return d?void(d=h(a)):!1});break;default:d=!a.isEmpty(e)}if(!d&&g.toast){var i=c.label||c.staticName;m.error(i+" does not appear to be a valid "+f)}}return d?void 0:!1}),d}function F(){var a=this;if(a.list&&a.list.effectivePermMask){var b=g.convertEffectivePermMask(a.list.effectivePermMask);return g.resolvePermissions(b)}return window.console.error("Attempted to resolve permissions of a model that hasn't been initialized.",a),g.resolvePermissions(null)}function G(a){return new n(a)}var H=i.defaultQueryName;return n.prototype={addNewItem:s,createEmptyItem:C,executeQuery:z,extendListMetadata:A,generateMockData:D,getAllListItems:q,getCache:w,getCachedEntity:x,getCachedEntities:y,getFieldDefinition:v,getListItemById:r,getQuery:u,isInitialised:B,resolvePermissions:F,registerQuery:t,validateEntity:E},{create:G,deepGroup:p,Model:n,searchLocalCache:o}}]),angular.module("angularPoint").factory("apQueryFactory",["_","apCacheService","apIndexedCacheFactory","apDataService","apConfig","$q","apDefaultListItemQueryOptions",function(a,b,c,d,e,f,g){function h(b,d){var h=this,i={changeToken:void 0,initialized:f.defer(),indexedCache:c.create(),lastRun:null,listName:d.list.getListId(),negotiatingWithServer:!1,operation:"GetListItemChangesSinceToken",cacheXML:!1,query:'<Query>   <OrderBy>       <FieldRef Name="ID" Ascending="TRUE"/>   </OrderBy></Query>',queryOptions:g,viewFields:d.list.viewFields};e.defaultUrl&&(i.webURL=e.defaultUrl),a.extend(h,i,b),h.getModel=function(){return d},h.getCache=j}function i(b){var c=this,e=c.getModel(),g=f.defer();if(c.negotiatingWithServer||a.isDate(c.lastRun)&&c.lastRun.getTime()+100>(new Date).getTime())return c.promise;c.negotiatingWithServer=!0;var h=a.isNull(c.lastRun),i={target:c.getCache()},j=a.extend({},i,b);return d.executeQuery(e,c,j).then(function(){h&&c.initialized.resolve(j.target),c.negotiatingWithServer=!1,e.lastServerUpdate=new Date,g.resolve(j.target)}),c.promise=g.promise,g.promise}function j(){var a=this;return a.indexedCache}function k(b,c){var d=this,e=d.getModel(),f={cacheName:d.name,localCache:d.getCache()},g=a.extend({},f,c);return e.searchLocalCache(b,g)}function l(a,b){return new h(a,b)}return h.prototype={execute:i,searchLocalCache:k},{create:l,Query:h}}]),angular.module("angularPoint").factory("apUserFactory",["apUtilityService",function(a){function b(b){var c=this,d=new a.SplitIndex(b),e=d.value.split(",#");1===e.length?(c.lookupId=d.id,c.lookupValue=d.value):(c.lookupId=d.id,c.lookupValue=e[0].replace(/(,,)/g,","),c.loginName=e[1].replace(/(,,)/g,","),c.email=e[2].replace(/(,,)/g,","),c.sipAddress=e[3].replace(/(,,)/g,","),c.title=e[4].replace(/(,,)/g,","))}var c=function(a){return new b(a)};return{create:c,User:b}}]),angular.module("angularPoint").service("apUserModel",["$q","_","apDataService",function(a,b,c){function d(a){return(!h||a)&&(h=c.getUserProfileByName()),h}function e(b){if(!g||b){var e=a.defer();d(b).then(function(a){c.getGroupCollectionFromUser(a.userLoginName).then(function(a){e.resolve(a)})}),g=e.promise}return g}function f(c,d){var e=a.defer(),f=this;return i.getGroupCollection(d).then(function(a){f.groupMap&&f.groupMap.length===a.length||(f.groupMap=[],b.each(a,function(a){f.groupMap.push(a.Name)})),e.resolve(b.isObject(a[f.groupMap.indexOf(c)]))}),e.promise}var g,h,i={checkIfMember:f,getGroupCollection:e,getUserProfile:d};return i}]),angular.module("angularPoint").directive("apSelect",["_",function(a){return{restrict:"A",replace:!0,templateUrl:"src/directives/ap_select/ap_select_tmpl.html",scope:{target:"=",bindedField:"=",multi:"=",arr:"=",lookupValue:"=",ngDisabled:"="},link:function(b){b.bindedField&&!b.target&&(b.target=b.bindedField),b.state={multiSelectIDs:[],singleSelectID:""},b.state.lookupField=b.lookupValue||"title";var c=function(c){var d=parseInt(c,10),e=a.findWhere(b.arr,{id:d});return{lookupId:d,lookupValue:e[b.state.lookupField]}};b.generateDisplayText=function(c){return a.isFunction(b.state.lookupField)?b.state.lookupField(c):a.isString(b.state.lookupField)?c[b.state.lookupField]:c.title},b.updateMultiModel=function(){a.isArray(b.target)||(b.target=[]),b.target.length=0,a.each(b.state.multiSelectIDs,function(a){b.target.push(c(a))})},b.updateSingleModel=function(){b.target=c(b.state.singleSelectID)},b.$watch("target",function(){b.multi?a.each(b.target,function(a){b.state.multiSelectIDs.push(a.lookupId.toString())}):a.isObject(b.target)&&b.target.lookupId&&(b.state.singleSelectID=b.target.lookupId)})}}}]),angular.module("angularPoint").run(["$templateCache",function(a){a.put("src/directives/ap_comments/ap_comments_tmpl.html",'<div><div class=pull-right><button class="btn btn-primary btn-xs" ng-click=createNewComment() title="Create a new comment" ng-show="state.tempComment.length > 0">Save</button> <button class="btn btn-default btn-xs" ng-click=clearTempVars() title="Cancel comment" ng-show="state.tempComment.length > 0">Cancel</button>    </div><div style="min-height: 150px"><div class=newComment><div class=form-group><h4><small>New Comment</small></h4><textarea class=form-control rows=2 ng-model=state.tempComment placeholder="Create a new comment..."></textarea></div></div><div class="alert text-center" style="margin-top: 30px" ng-show=!state.ready><h4><small>loading...</small></h4></div><div class=grey style="margin-top: 30px" ng-show="!comments && !state.newCommentVisible && state.ready">No comments have been made. Create one using the input box above.</div><div ng-if="comments && comments.thread.length > 0" class=comments-container><span ng-include="\'src/directives/ap_comments/ap_recursive_comment.html\'" ng-init="comment = comments;"></span></div></div></div>'),a.put("src/directives/ap_comments/ap_recursive_comment.html",'<ul class=comments><li class=comment ng-repeat="response in comment.thread" style="border-top-width: 1px;border-top-color: grey"><div class=comment-content><div class=content><h5><small><span class=author>{{ response.author.lookupValue }}</span> <span>{{ response.modified | date:\'short\' }}</span> <button class="btn btn-link btn-xs" ng-click="state.respondingTo = response"><i class="fa fa-mail-reply"></i> Reply</button> <button class="btn btn-link btn-xs" ng-click=deleteComment(response)><i class="fa fa-trash-o"></i> Delete</button></small></h5><p class=comment-text>{{ response.comment }}</p></div></div><div ng-if="state.respondingTo === response"><div class=row><div class=col-xs-12><form><div class=form-group><h5><small>Response<label class=pull-right><button class="btn btn-link btn-xs" ng-click=createResponse(response)><i class="fa fa-save"></i> Save</button> <button class="btn btn-link btn-xs" ng-click=clearTempVars()><i class="fa fa-undo"></i> Cancel</button></label></small></h5><textarea class=form-control rows=2 ng-model=state.tempResponse></textarea></div></form></div></div></div><div ng-if="response.thread.length !== -1"><span ng-include="\'src/directives/ap_comments/ap_recursive_comment.html\'" ng-init="comment = response;"></span></div></li></ul>'),a.put("src/directives/ap_select/ap_select_tmpl.html",'<span class=ng-cloak><span ng-if=!multi><select class=form-control ng-model=state.singleSelectID ng-change=updateSingleModel() style="width: 100%" ng-disabled=ngDisabled ng-options="lookup.id as lookup[state.lookupField] for lookup in arr"></select></span> <span ng-if=multi><select multiple ui-select2 ng-model=state.multiSelectIDs ng-change=updateMultiModel() style="width: 100%" ng-disabled=ngDisabled><option></option><option ng-repeat="lookup in arr" value="{{ lookup.id }}" ng-bind=lookup[state.lookupField]>&nbsp;</option></select></span></span>')}]);